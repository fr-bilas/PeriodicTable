<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Professional Periodic Table ‚Äî HD Export & Interactive</title>
  <style>
    :root{
      --bg:#0b1220; --card:#0f1724; --text:#e6eef8; --muted:#9aa6b2; --ring:#38bdf8;
      --grid-gap:.36rem; --radius:6px; --shadow:0 10px 30px rgba(2,6,23,.6), inset 0 0 0 1px rgba(255,255,255,.02);
      --animate-ease:cubic-bezier(.16,.84,.44,1);
      --c-alkali:#ef4444; --c-alkaline:#f59e0b; --c-transition:#eab308; --c-post:#84cc16; --c-metalloid:#10b981; --c-nonmetal:#38bdf8; --c-halogen:#a78bfa; --c-noble:#e879f9;
    }
    .light{--bg:#f8fafc;--card:#ffffff;--text:#082032;--muted:#466070;--shadow:0 8px 24px rgba(2,6,23,.06)}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,Segoe UI,Roboto,system-ui,Arial}
    .wrap{max-width:1360px;margin:24px auto;padding:22px}
    .header{display:flex;align-items:center;gap:16px}
    .title{font-weight:800;font-size:22px}
    .subtitle{color:var(--muted);font-size:13px}

    .controls{display:flex;gap:12px;align-items:center;margin:14px 0;flex-wrap:wrap}
    .search{background:var(--card);padding:8px 12px;border-radius:10px;display:flex;gap:8px;align-items:center;box-shadow:var(--shadow)}
    .search input{background:transparent;border:0;color:var(--text);outline:none;width:320px;font-size:14px}
    .btn, .chip-btn{background:var(--card);border:0;padding:8px 12px;border-radius:10px;color:var(--text);box-shadow:var(--shadow);cursor:pointer}

    /* category list area (user requested: show the words as clickable) */
    .cats{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
    .chip-btn{display:flex;align-items:center;gap:8px;font-weight:600}
    .chip-btn.active{box-shadow:0 10px 30px rgba(56,189,248,.12), 0 0 0 3px rgba(56,189,248,.06);transform:translateY(-3px)}

    /* Grid styling */
    .grid-wrap{background:transparent;padding:14px;border-radius:12px}
    .grid{display:grid;grid-template-columns:repeat(18,1fr);gap:var(--grid-gap);margin-top:10px}
    .cell{position:relative;border-radius:var(--radius);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:14px;min-height:86px;overflow:visible;transform:translateY(10px) scale(.98);opacity:0;transition:transform .42s var(--animate-ease),opacity .42s var(--animate-ease),box-shadow .2s;backface-visibility:hidden;will-change:transform,opacity,box-shadow}
    .cell.show{transform:none;opacity:1}
    .cell:focus{outline:none;box-shadow:0 8px 28px rgba(0,0,0,.5),0 0 0 3px var(--ring)}
    .z{position:absolute;top:10px;left:12px;font-size:12px;color:var(--muted)}
    .mass{position:absolute;top:10px;right:12px;font-size:12px;color:var(--muted)}
    .sym{font-weight:800;font-size:28px;letter-spacing:.6px;margin-top:8px}
    .name{font-size:13px;margin-top:6px;line-height:1.02}

    .ring{position:absolute;inset:0;border-radius:var(--radius);pointer-events:none;border:3px solid transparent}

    /* highlight styles when category or search matches */
    .cell.dim{opacity:.14;transform:scale(.96);filter:grayscale(.6)}
    .cell.highlight{box-shadow:0 18px 48px rgba(56,189,248,.12);transform:translateY(-8px) scale(1.03);border:2px solid rgba(56,189,248,.08)}
    .pulse{animation:pulse 1.4s infinite ease-in-out}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(56,189,248,.10)}50%{box-shadow:0 0 58px 12px rgba(56,189,248,.05)}100%{box-shadow:0 0 0 0 rgba(56,189,248,0)}}

    /* lanth/act rows */
    .f-block{display:grid;grid-template-columns:repeat(15,1fr);gap:var(--grid-gap);margin-top:10px}
    .f-caption{margin-top:12px;color:var(--muted);font-weight:700}

    /* tooltip */
    .tip{position:fixed;background:var(--card);color:var(--text);padding:12px;border-radius:12px;box-shadow:0 18px 48px rgba(2,6,23,.7);z-index:9999;min-width:240px;display:none}
    .tip.show{display:block;animation:pop .18s cubic-bezier(.2,.8,.2,1)}
    @keyframes pop{from{transform:translateY(6px) scale(.98);opacity:0}to{transform:translateY(0) scale(1);opacity:1}}

    .download-note{font-size:13px;color:var(--muted);margin-top:8px}

    @media (max-width:1100px){ .search input{width:180px} }
    @media (max-width:900px){ .grid{grid-template-columns:repeat(9,1fr)} .f-block{grid-template-columns:repeat(9,1fr)} .search input{width:140px} }
  </style>
</head>
<body>
  <div class="wrap" id="app">
    <div class="header">
      <div>
        <div class="title">Professional Periodic Table ‚Äî HD Export & Interactive</div>
        <div class="subtitle">Click category names to filter & highlight. Search highlights results. Export PNG or PDF.</div>
      </div>
    </div>

    <div class="controls">
      <label class="search" title="Search (name, symbol, Z)">üîé <input id="q" placeholder="‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®: ‡¶®‡¶æ‡¶Æ / ‡¶™‡ßç‡¶∞‡¶§‡ßÄ‡¶ï / Z" /></label>
      <div class="cats" id="cats" aria-hidden="false" role="list"></div>
      <button id="export-png" class="btn">Export PNG (1920√ó1080)</button>
      <button id="export-pdf" class="btn">Export PDF</button>
      <button id="theme" class="btn">üåô</button>
    </div>

    <div class="grid-wrap" id="gridArea">
      <div id="grid" class="grid" role="grid" aria-label="Periodic Table"></div>
      <div class="f-caption">Lanthanides & Actinides</div>
      <div id="fblock" class="f-block" aria-hidden="false"></div>
    </div>

    <div class="download-note">Tip: Use PNG for images, PDF for printable results. If export fails in Electron, see the Electron notes (we can fix with main-process capture).</div>
  </div>

  <!-- html2canvas + jsPDF for export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    // Full 118 elements dataset (z,s,n,m,p,g,c,ec)
    const ELEMENTS = [
      {z:1,s:'H',n:'Hydrogen',m:'1.008',p:1,g:1,c:'nonmetal',ec:'1s1'},
      {z:2,s:'He',n:'Helium',m:'4.0026',p:1,g:18,c:'noble gas',ec:'1s2'},
      {z:3,s:'Li',n:'Lithium',m:'6.94',p:2,g:1,c:'alkali metal',ec:'[He] 2s1'},
      {z:4,s:'Be',n:'Beryllium',m:'9.0122',p:2,g:2,c:'alkaline earth metal',ec:'[He] 2s2'},
      {z:5,s:'B',n:'Boron',m:'10.81',p:2,g:13,c:'metalloid',ec:'[He] 2s2 2p1'},
      {z:6,s:'C',n:'Carbon',m:'12.011',p:2,g:14,c:'nonmetal',ec:'[He] 2s2 2p2'},
      {z:7,s:'N',n:'Nitrogen',m:'14.007',p:2,g:15,c:'nonmetal',ec:'[He] 2s2 2p3'},
      {z:8,s:'O',n:'Oxygen',m:'15.999',p:2,g:16,c:'nonmetal',ec:'[He] 2s2 2p4'},
      {z:9,s:'F',n:'Fluorine',m:'18.998',p:2,g:17,c:'halogen',ec:'[He] 2s2 2p5'},
      {z:10,s:'Ne',n:'Neon',m:'20.180',p:2,g:18,c:'noble gas',ec:'[He] 2s2 2p6'},
      {z:11,s:'Na',n:'Sodium',m:'22.990',p:3,g:1,c:'alkali metal',ec:'[Ne] 3s1'},
      {z:12,s:'Mg',n:'Magnesium',m:'24.305',p:3,g:2,c:'alkaline earth metal',ec:'[Ne] 3s2'},
      {z:13,s:'Al',n:'Aluminium',m:'26.982',p:3,g:13,c:'post-transition metal',ec:'[Ne] 3s2 3p1'},
      {z:14,s:'Si',n:'Silicon',m:'28.085',p:3,g:14,c:'metalloid',ec:'[Ne] 3s2 3p2'},
      {z:15,s:'P',n:'Phosphorus',m:'30.974',p:3,g:15,c:'nonmetal',ec:'[Ne] 3s2 3p3'},
      {z:16,s:'S',n:'Sulfur',m:'32.06',p:3,g:16,c:'nonmetal',ec:'[Ne] 3s2 3p4'},
      {z:17,s:'Cl',n:'Chlorine',m:'35.45',p:3,g:17,c:'halogen',ec:'[Ne] 3s2 3p5'},
      {z:18,s:'Ar',n:'Argon',m:'39.948',p:3,g:18,c:'noble gas',ec:'[Ne] 3s2 3p6'},
      {z:19,s:'K',n:'Potassium',m:'39.098',p:4,g:1,c:'alkali metal',ec:'[Ar] 4s1'},
      {z:20,s:'Ca',n:'Calcium',m:'40.078',p:4,g:2,c:'alkaline earth metal',ec:'[Ar] 4s2'},
      {z:21,s:'Sc',n:'Scandium',m:'44.956',p:4,g:3,c:'transition metal',ec:'[Ar] 3d1 4s2'},
      {z:22,s:'Ti',n:'Titanium',m:'47.867',p:4,g:4,c:'transition metal',ec:'[Ar] 3d2 4s2'},
      {z:23,s:'V',n:'Vanadium',m:'50.942',p:4,g:5,c:'transition metal',ec:'[Ar] 3d3 4s2'},
      {z:24,s:'Cr',n:'Chromium',m:'51.996',p:4,g:6,c:'transition metal',ec:'[Ar] 3d5 4s1'},
      {z:25,s:'Mn',n:'Manganese',m:'54.938',p:4,g:7,c:'transition metal',ec:'[Ar] 3d5 4s2'},
      {z:26,s:'Fe',n:'Iron',m:'55.845',p:4,g:8,c:'transition metal',ec:'[Ar] 3d6 4s2'},
      {z:27,s:'Co',n:'Cobalt',m:'58.933',p:4,g:9,c:'transition metal',ec:'[Ar] 3d7 4s2'},
      {z:28,s:'Ni',n:'Nickel',m:'58.693',p:4,g:10,c:'transition metal',ec:'[Ar] 3d8 4s2'},
      {z:29,s:'Cu',n:'Copper',m:'63.546',p:4,g:11,c:'transition metal',ec:'[Ar] 3d10 4s1'},
      {z:30,s:'Zn',n:'Zinc',m:'65.38',p:4,g:12,c:'transition metal',ec:'[Ar] 3d10 4s2'},
      {z:31,s:'Ga',n:'Gallium',m:'69.723',p:4,g:13,c:'post-transition metal',ec:'[Ar] 3d10 4s2 4p1'},
      {z:32,s:'Ge',n:'Germanium',m:'72.630',p:4,g:14,c:'metalloid',ec:'[Ar] 3d10 4s2 4p2'},
      {z:33,s:'As',n:'Arsenic',m:'74.922',p:4,g:15,c:'metalloid',ec:'[Ar] 3d10 4s2 4p3'},
      {z:34,s:'Se',n:'Selenium',m:'78.971',p:4,g:16,c:'nonmetal',ec:'[Ar] 3d10 4s2 4p4'},
      {z:35,s:'Br',n:'Bromine',m:'79.904',p:4,g:17,c:'halogen',ec:'[Ar] 3d10 4s2 4p5'},
      {z:36,s:'Kr',n:'Krypton',m:'83.798',p:4,g:18,c:'noble gas',ec:'[Ar] 3d10 4s2 4p6'},
      {z:37,s:'Rb',n:'Rubidium',m:'85.468',p:5,g:1,c:'alkali metal',ec:'[Kr] 5s1'},
      {z:38,s:'Sr',n:'Strontium',m:'87.62',p:5,g:2,c:'alkaline earth metal',ec:'[Kr] 5s2'},
      {z:39,s:'Y',n:'Yttrium',m:'88.906',p:5,g:3,c:'transition metal',ec:'[Kr] 4d1 5s2'},
      {z:40,s:'Zr',n:'Zirconium',m:'91.224',p:5,g:4,c:'transition metal',ec:'[Kr] 4d2 5s2'},
      {z:41,s:'Nb',n:'Niobium',m:'92.906',p:5,g:5,c:'transition metal',ec:'[Kr] 4d4 5s1'},
      {z:42,s:'Mo',n:'Molybdenum',m:'95.95',p:5,g:6,c:'transition metal',ec:'[Kr] 4d5 5s1'},
      {z:43,s:'Tc',n:'Technetium',m:'98',p:5,g:7,c:'transition metal',ec:'[Kr] 4d5 5s2'},
      {z:44,s:'Ru',n:'Ruthenium',m:'101.07',p:5,g:8,c:'transition metal',ec:'[Kr] 4d7 5s1'},
      {z:45,s:'Rh',n:'Rhodium',m:'102.91',p:5,g:9,c:'transition metal',ec:'[Kr] 4d8 5s1'},
      {z:46,s:'Pd',n:'Palladium',m:'106.42',p:5,g:10,c:'transition metal',ec:'[Kr] 4d10'},
      {z:47,s:'Ag',n:'Silver',m:'107.87',p:5,g:11,c:'transition metal',ec:'[Kr] 4d10 5s1'},
      {z:48,s:'Cd',n:'Cadmium',m:'112.41',p:5,g:12,c:'transition metal',ec:'[Kr] 4d10 5s2'},
      {z:49,s:'In',n:'Indium',m:'114.82',p:5,g:13,c:'post-transition metal',ec:'[Kr] 4d10 5s2 5p1'},
      {z:50,s:'Sn',n:'Tin',m:'118.71',p:5,g:14,c:'post-transition metal',ec:'[Kr] 4d10 5s2 5p2'},
      {z:51,s:'Sb',n:'Antimony',m:'121.76',p:5,g:15,c:'metalloid',ec:'[Kr] 4d10 5s2 5p3'},
      {z:52,s:'Te',n:'Tellurium',m:'127.60',p:5,g:16,c:'metalloid',ec:'[Kr] 4d10 5s2 5p4'},
      {z:53,s:'I',n:'Iodine',m:'126.90',p:5,g:17,c:'halogen',ec:'[Kr] 4d10 5s2 5p5'},
      {z:54,s:'Xe',n:'Xenon',m:'131.29',p:5,g:18,c:'noble gas',ec:'[Kr] 4d10 5s2 5p6'},
      {z:55,s:'Cs',n:'Caesium',m:'132.91',p:6,g:1,c:'alkali metal',ec:'[Xe] 6s1'},
      {z:56,s:'Ba',n:'Barium',m:'137.33',p:6,g:2,c:'alkaline earth metal',ec:'[Xe] 6s2'},
      {z:57,s:'La',n:'Lanthanum',m:'138.91',p:8,g:1,c:'lanthanide',ec:'[Xe] 5d1 6s2'},
      {z:58,s:'Ce',n:'Cerium',m:'140.12',p:8,g:2,c:'lanthanide',ec:'[Xe] 4f1 5d1 6s2'},
      {z:59,s:'Pr',n:'Praseodymium',m:'140.91',p:8,g:3,c:'lanthanide',ec:'[Xe] 4f3 6s2'},
      {z:60,s:'Nd',n:'Neodymium',m:'144.24',p:8,g:4,c:'lanthanide',ec:'[Xe] 4f4 6s2'},
      {z:61,s:'Pm',n:'Promethium',m:'145',p:8,g:5,c:'lanthanide',ec:'[Xe] 4f5 6s2'},
      {z:62,s:'Sm',n:'Samarium',m:'150.36',p:8,g:6,c:'lanthanide',ec:'[Xe] 4f6 6s2'},
      {z:63,s:'Eu',n:'Europium',m:'151.96',p:8,g:7,c:'lanthanide',ec:'[Xe] 4f7 6s2'},
      {z:64,s:'Gd',n:'Gadolinium',m:'157.25',p:8,g:8,c:'lanthanide',ec:'[Xe] 4f7 5d1 6s2'},
      {z:65,s:'Tb',n:'Terbium',m:'158.93',p:8,g:9,c:'lanthanide',ec:'[Xe] 4f9 6s2'},
      {z:66,s:'Dy',n:'Dysprosium',m:'162.50',p:8,g:10,c:'lanthanide',ec:'[Xe] 4f10 6s2'},
      {z:67,s:'Ho',n:'Holmium',m:'164.93',p:8,g:11,c:'lanthanide',ec:'[Xe] 4f11 6s2'},
      {z:68,s:'Er',n:'Erbium',m:'167.26',p:8,g:12,c:'lanthanide',ec:'[Xe] 4f12 6s2'},
      {z:69,s:'Tm',n:'Thulium',m:'168.93',p:8,g:13,c:'lanthanide',ec:'[Xe] 4f13 6s2'},
      {z:70,s:'Yb',n:'Ytterbium',m:'173.05',p:8,g:14,c:'lanthanide',ec:'[Xe] 4f14 6s2'},
      {z:71,s:'Lu',n:'Lutetium',m:'174.97',p:8,g:15,c:'lanthanide',ec:'[Xe] 4f14 5d1 6s2'},
      {z:72,s:'Hf',n:'Hafnium',m:'178.49',p:6,g:4,c:'transition metal',ec:'[Xe] 4f14 5d2 6s2'},
      {z:73,s:'Ta',n:'Tantalum',m:'180.95',p:6,g:5,c:'transition metal',ec:'[Xe] 4f14 5d3 6s2'},
      {z:74,s:'W',n:'Tungsten',m:'183.84',p:6,g:6,c:'transition metal',ec:'[Xe] 4f14 5d4 6s2'},
      {z:75,s:'Re',n:'Rhenium',m:'186.21',p:6,g:7,c:'transition metal',ec:'[Xe] 4f14 5d5 6s2'},
      {z:76,s:'Os',n:'Osmium',m:'190.23',p:6,g:8,c:'transition metal',ec:'[Xe] 4f14 5d6 6s2'},
      {z:77,s:'Ir',n:'Iridium',m:'192.22',p:6,g:9,c:'transition metal',ec:'[Xe] 4f14 5d7 6s2'},
      {z:78,s:'Pt',n:'Platinum',m:'195.08',p:6,g:10,c:'transition metal',ec:'[Xe] 4f14 5d9 6s1'},
      {z:79,s:'Au',n:'Gold',m:'196.97',p:6,g:11,c:'transition metal',ec:'[Xe] 4f14 5d10 6s1'},
      {z:80,s:'Hg',n:'Mercury',m:'200.59',p:6,g:12,c:'transition metal',ec:'[Xe] 4f14 5d10 6s2'},
      {z:81,s:'Tl',n:'Thallium',m:'204.38',p:6,g:13,c:'post-transition metal',ec:'[Xe] 4f14 5d10 6s2 6p1'},
      {z:82,s:'Pb',n:'Lead',m:'207.2',p:6,g:14,c:'post-transition metal',ec:'[Xe] 4f14 5d10 6s2 6p2'},
      {z:83,s:'Bi',n:'Bismuth',m:'208.98',p:6,g:15,c:'post-transition metal',ec:'[Xe] 4f14 5d10 6s2 6p3'},
      {z:84,s:'Po',n:'Polonium',m:'209',p:6,g:16,c:'post-transition metal',ec:'[Xe] 4f14 5d10 6s2 6p4'},
      {z:85,s:'At',n:'Astatine',m:'210',p:6,g:17,c:'halogen',ec:'[Xe] 4f14 5d10 6s2 6p5'},
      {z:86,s:'Rn',n:'Radon',m:'222',p:6,g:18,c:'noble gas',ec:'[Xe] 4f14 5d10 6s2 6p6'},
      {z:87,s:'Fr',n:'Francium',m:'223',p:7,g:1,c:'alkali metal',ec:'[Rn] 7s1'},
      {z:88,s:'Ra',n:'Radium',m:'226',p:7,g:2,c:'alkaline earth metal',ec:'[Rn] 7s2'},
      {z:89,s:'Ac',n:'Actinium',m:'227',p:9,g:1,c:'actinide',ec:'[Rn] 6d1 7s2'},
      {z:90,s:'Th',n:'Thorium',m:'232.04',p:9,g:2,c:'actinide',ec:'[Rn] 6d2 7s2'},
      {z:91,s:'Pa',n:'Protactinium',m:'231.04',p:9,g:3,c:'actinide',ec:'[Rn] 5f2 6d1 7s2'},
      {z:92,s:'U',n:'Uranium',m:'238.03',p:9,g:4,c:'actinide',ec:'[Rn] 5f3 6d1 7s2'},
      {z:93,s:'Np',n:'Neptunium',m:'237',p:9,g:5,c:'actinide',ec:'[Rn] 5f4 6d1 7s2'},
      {z:94,s:'Pu',n:'Plutonium',m:'244',p:9,g:6,c:'actinide',ec:'[Rn] 5f6 7s2'},
      {z:95,s:'Am',n:'Americium',m:'243',p:9,g:7,c:'actinide',ec:'[Rn] 5f7 7s2'},
      {z:96,s:'Cm',n:'Curium',m:'247',p:9,g:8,c:'actinide',ec:'[Rn] 5f7 6d1 7s2'},
      {z:97,s:'Bk',n:'Berkelium',m:'247',p:9,g:9,c:'actinide',ec:'[Rn] 5f9 7s2'},
      {z:98,s:'Cf',n:'Californium',m:'251',p:9,g:10,c:'actinide',ec:'[Rn] 5f10 7s2'},
      {z:99,s:'Es',n:'Einsteinium',m:'252',p:9,g:11,c:'actinide',ec:'[Rn] 5f11 7s2'},
      {z:100,s:'Fm',n:'Fermium',m:'257',p:9,g:12,c:'actinide',ec:'[Rn] 5f12 7s2'},
      {z:101,s:'Md',n:'Mendelevium',m:'258',p:9,g:13,c:'actinide',ec:'[Rn] 5f13 7s2'},
      {z:102,s:'No',n:'Nobelium',m:'259',p:9,g:14,c:'actinide',ec:'[Rn] 5f14 7s2'},
      {z:103,s:'Lr',n:'Lawrencium',m:'266',p:9,g:15,c:'actinide',ec:'[Rn] 5f14 7s2 7p1'},
      {z:104,s:'Rf',n:'Rutherfordium',m:'267',p:7,g:4,c:'transition metal',ec:'[Rn] 5f14 6d2 7s2'},
      {z:105,s:'Db',n:'Dubnium',m:'268',p:7,g:5,c:'transition metal',ec:'[Rn] 5f14 6d3 7s2'},
      {z:106,s:'Sg',n:'Seaborgium',m:'269',p:7,g:6,c:'transition metal',ec:'[Rn] 5f14 6d4 7s2'},
      {z:107,s:'Bh',n:'Bohrium',m:'270',p:7,g:7,c:'transition metal',ec:'[Rn] 5f14 6d5 7s2'},
      {z:108,s:'Hs',n:'Hassium',m:'269',p:7,g:8,c:'transition metal',ec:'[Rn] 5f14 6d6 7s2'},
      {z:109,s:'Mt',n:'Meitnerium',m:'278',p:7,g:9,c:'transition metal',ec:''},
      {z:110,s:'Ds',n:'Darmstadtium',m:'281',p:7,g:10,c:'transition metal',ec:''},
      {z:111,s:'Rg',n:'Roentgenium',m:'282',p:7,g:11,c:'transition metal',ec:''},
      {z:112,s:'Cn',n:'Copernicium',m:'285',p:7,g:12,c:'transition metal',ec:''},
      {z:113,s:'Nh',n:'Nihonium',m:'286',p:7,g:13,c:'post-transition metal',ec:''},
      {z:114,s:'Fl',n:'Flerovium',m:'289',p:7,g:14,c:'post-transition metal',ec:''},
      {z:115,s:'Mc',n:'Moscovium',m:'290',p:7,g:15,c:'post-transition metal',ec:''},
      {z:116,s:'Lv',n:'Livermorium',m:'293',p:7,g:16,c:'post-transition metal',ec:''},
      {z:117,s:'Ts',n:'Tennessine',m:'294',p:7,g:17,c:'halogen',ec:''},
      {z:118,s:'Og',n:'Oganesson',m:'294',p:7,g:18,c:'noble gas',ec:''}
    ];

    // DATA will be ELEMENTS
    const DATA = ELEMENTS.slice();

    const CAT_ORDER = ['all','alkali metal','alkaline earth metal','transition metal','post-transition metal','metalloid','nonmetal','halogen','noble gas','lanthanide','actinide'];
    const CAT_LABEL = {
      'all':'All','alkali metal':'Alkali','alkaline earth metal':'Alkaline','transition metal':'Transition','post-transition metal':'Post‚Äëtransition','metalloid':'Metalloid','nonmetal':'Nonmetal','halogen':'Halogen','noble gas':'Noble gas','lanthanide':'Lanthanide','actinide':'Actinide'
    };

    const CAT_COLOR = { 'alkali metal':'var(--c-alkali)', 'alkaline earth metal':'var(--c-alkaline)', 'transition metal':'var(--c-transition)', 'post-transition metal':'var(--c-post)', 'metalloid':'var(--c-metalloid)', 'nonmetal':'var(--c-nonmetal)', 'halogen':'var(--c-halogen)', 'noble gas':'var(--c-noble)','lanthanide':'var(--c-post)','actinide':'var(--c-post)'};

    const grid = document.getElementById('grid');
    const fblock = document.getElementById('fblock');
    const q = document.getElementById('q');
    const catsEl = document.getElementById('cats');
    const themeBtn = document.getElementById('theme');
    const exportPng = document.getElementById('export-png');
    const exportPdf = document.getElementById('export-pdf');
    const gridArea = document.getElementById('gridArea');

    let activeCat = 'all';
    let light = false;

    // build category buttons (user wanted the words visible)
    CAT_ORDER.forEach(cat =>{
      const b = document.createElement('button'); b.className='chip-btn'; b.textContent = CAT_LABEL[cat] || cat; b.dataset.cat=cat; b.style.border = '1px solid rgba(255,255,255,0.03)';
      const dot = document.createElement('span'); dot.className='dot'; dot.style.background = CAT_COLOR[cat] || 'linear-gradient(90deg,#777,#bbb)'; dot.style.display='inline-block'; dot.style.width='10px'; dot.style.height='10px'; dot.style.borderRadius='50%'; b.prepend(dot);
      b.addEventListener('click', ()=>{ if(activeCat===cat) activeCat='all'; else activeCat=cat; updateActiveCat(); render(); });
      catsEl.appendChild(b);
    });

    function updateActiveCat(){
      document.querySelectorAll('.chip-btn').forEach(btn=>{ if(btn.dataset.cat===activeCat) btn.classList.add('active'); else btn.classList.remove('active'); });
    }

    themeBtn.addEventListener('click', ()=>{ light=!light; document.documentElement.classList.toggle('light', light); themeBtn.textContent = light? '‚òÄÔ∏è':'üåô'; });

    function matchesFilter(el){
      const text = (q.value||'').trim().toLowerCase();
      const byCat = activeCat === 'all' ? '' : activeCat;
      const t = !text || el.n.toLowerCase().includes(text) || el.s.toLowerCase()===text || String(el.z)===text;
      const c = !byCat || el.c===byCat;
      return t && c;
    }

    function createCell(el, i){
      const cell = document.createElement('button');
      cell.className='cell';
      cell.setAttribute('role','gridcell');
      cell.setAttribute('tabindex','0');
      if(el.g && el.p && el.p<=7) cell.style.gridColumn = el.g; cell.style.gridRow = el.p;
      const ring = document.createElement('span'); ring.className='ring'; ring.style.borderColor = CAT_COLOR[el.c]||'transparent'; cell.appendChild(ring);
      const zn = document.createElement('div'); zn.className='z'; zn.textContent = el.z; cell.appendChild(zn);
      const ms = document.createElement('div'); ms.className='mass'; ms.textContent = el.m; cell.appendChild(ms);
      const sy = document.createElement('div'); sy.className='sym'; sy.textContent = el.s; cell.appendChild(sy);
      const nm = document.createElement('div'); nm.className='name'; nm.textContent = el.n; cell.appendChild(nm);

      const tip = document.createElement('div'); tip.className='tip'; tip.innerHTML = `<strong style="display:block">${el.n} <small style='color:var(--muted)'>‚Ä¢ Z ${el.z}</small></strong><div style='margin-top:6px' class='mono'>${el.ec||''}</div><div style='margin-top:6px;color:var(--muted);font-size:13px'>Category: <span style='color:var(--text)'>${el.c}</span></div>`;
      document.body.appendChild(tip);

      let hoverTimer;
      cell.addEventListener('mouseenter', ()=>{ clearTimeout(hoverTimer); showTooltip(cell, tip); });
      cell.addEventListener('focus', ()=>{ showTooltip(cell, tip); });
      cell.addEventListener('mouseleave', ()=>{ hoverTimer = setTimeout(()=>hideTooltip(tip),120); });
      cell.addEventListener('blur', ()=>{ hideTooltip(tip); });
      cell.addEventListener('click', (e)=>{ e.stopPropagation(); if(tip.classList.contains('show')) hideTooltip(tip); else showTooltip(cell, tip); });

      return {cell, tip};
    }

    function showTooltip(cell, tip){
      const r = cell.getBoundingClientRect(); tip.classList.add('show'); tip.style.left = (Math.max(12, r.left + r.width/2)) + 'px'; const above = r.top - tip.offsetHeight - 12; if(above > 8) tip.style.top = (r.top - tip.offsetHeight - 10) + 'px'; else tip.style.top = (r.bottom + 10) + 'px'; tip.style.position='fixed'; tip.style.zIndex=9999; }
    function hideTooltip(tip){ tip.classList.remove('show'); }

    function render(){
      grid.innerHTML=''; fblock.innerHTML='';
      const visible = DATA.filter(matchesFilter);
      const visibleSet = new Set(visible.map(e=>e.z));

      // main table (periods 1-7)
      DATA.filter(e=>e.p && e.p<=7).forEach((el,i)=>{
        const {cell, tip} = createCell(el,i);
        if(visibleSet.has(el.z)){
          cell.classList.add('highlight'); cell.classList.add('pulse'); setTimeout(()=>cell.classList.remove('pulse'), 1200);
        }else{
          if(q.value.trim()!=='' || (activeCat && activeCat!=='all')) cell.classList.add('dim');
        }
        grid.appendChild(cell);
        requestAnimationFrame(()=> setTimeout(()=>cell.classList.add('show'), i*12));
      });

      // f-block rows: lanthanides then actinides
      const lan = DATA.filter(e=>e.c==='lanthanide');
      const act = DATA.filter(e=>e.c==='actinide');
      lan.forEach((el,i)=>{
        const cell = document.createElement('button'); cell.className='cell'; const sy = document.createElement('div'); sy.className='sym'; sy.textContent=el.s; const nm = document.createElement('div'); nm.className='name'; nm.textContent=el.n; const zn = document.createElement('div'); zn.className='z'; zn.textContent=el.z; cell.appendChild(zn); cell.appendChild(sy); cell.appendChild(nm); const ring=document.createElement('span'); ring.className='ring'; ring.style.borderColor=CAT_COLOR[el.c]||'transparent'; cell.appendChild(ring); fblock.appendChild(cell); setTimeout(()=>cell.classList.add('show'), i*16);
      });
      act.forEach((el,i)=>{
        const cell = document.createElement('button'); cell.className='cell'; const sy = document.createElement('div'); sy.className='sym'; sy.textContent=el.s; const nm = document.createElement('div'); nm.className='name'; nm.textContent=el.n; const zn = document.createElement('div'); zn.className='z'; zn.textContent=el.z; cell.appendChild(zn); cell.appendChild(sy); cell.appendChild(nm); const ring=document.createElement('span'); ring.className='ring'; ring.style.borderColor=CAT_COLOR[el.c]||'transparent'; cell.appendChild(ring); fblock.appendChild(cell); setTimeout(()=>cell.classList.add('show'), (lan.length+i)*16);
      });
    }

    // close tooltips on body click
    document.body.addEventListener('click', ()=>{ document.querySelectorAll('.tip.show').forEach(t=>t.classList.remove('show')); });

    q.addEventListener('input', ()=>{ render(); });

    // robust Export PNG: clone, inline fonts/colors, scale
    async function exportAreaAsImage(targetW=1920,targetH=1080){
      const area = gridArea;
      // clone area to avoid visible change
      const clone = area.cloneNode(true);
      clone.style.boxShadow = 'none'; clone.style.background = '#ffffff'; clone.style.transform = 'none'; clone.style.padding = '20px';
      // create wrapper
      const wrapper = document.createElement('div'); wrapper.style.width = area.offsetWidth + 'px'; wrapper.style.padding = '20px'; wrapper.style.background = '#ffffff'; wrapper.appendChild(clone);
      document.body.appendChild(wrapper);
      // compute scale
      const rect = wrapper.getBoundingClientRect();
      const scale = Math.min(targetW/rect.width, targetH/rect.height) * (window.devicePixelRatio || 1);
      try{
        const canvas = await html2canvas(wrapper, {scale: scale, useCORS:true, backgroundColor:'#ffffff', logging:false});
        const final = document.createElement('canvas'); final.width = targetW; final.height = targetH; const ctx = final.getContext('2d'); ctx.fillStyle = '#ffffff'; ctx.fillRect(0,0,targetW,targetH);
        const dx = (targetW - canvas.width)/2; const dy = (targetH - canvas.height)/2; ctx.drawImage(canvas, dx, dy);
        const url = final.toDataURL('image/png'); document.body.removeChild(wrapper); return url;
      }catch(err){ document.body.removeChild(wrapper); throw err; }
    }

    exportPng.addEventListener('click', async ()=>{
      try{
        const url = await exportAreaAsImage(1920,1080);
        const a = document.createElement('a'); a.href = url; a.download = 'periodic-table-1920x1080.png'; a.click();
      }catch(err){ alert('Export PNG failed: '+err.message); }
    });

    exportPdf.addEventListener('click', async ()=>{
      try{
        const imgUrl = await exportAreaAsImage(2480,1754); // high-res roughly A4@300dpi
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({orientation:'landscape', unit:'pt', format:'a4'});
        // add as image filling page
        const pageW = pdf.internal.pageSize.getWidth(), pageH = pdf.internal.pageSize.getHeight();
        pdf.addImage(imgUrl, 'PNG', 0, 0, pageW, pageH);
        pdf.save('periodic-table.pdf');
      }catch(err){ alert('Export PDF failed: '+err.message); }
    });

    // initial render
    document.addEventListener('DOMContentLoaded', ()=>{ updateActiveCat(); render(); });

    // Electron note: if rendering inside Electron still shows issues, use main-process capture (nativeImage or capturePage) for pixel-perfect export. I can provide the snippet.
  </script>
</body>
</html>
